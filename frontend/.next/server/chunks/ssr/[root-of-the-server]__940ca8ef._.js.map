{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///D:/FYP/Fyp/fyp/lib/api.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\nconst api = axios.create({\r\n  baseURL: \"http://localhost:5000/api\", // Your backend URL\r\n});\r\n\r\nexport default api;\r\n"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,MAAM,MAAM,qHAAK,CAAC,MAAM,CAAC;IACvB,SAAS;AACX;uCAEe","debugId":null}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///D:/FYP/Fyp/fyp/lib/auth.js"],"sourcesContent":["// export const setToken = (token) => {\r\n//   localStorage.setItem(\"token\", token);\r\n// };\r\n\r\n// export const getToken = () => {\r\n//   return localStorage.getItem(\"token\");\r\n// };\r\n\r\n// export const removeToken = () => {\r\n//   localStorage.removeItem(\"token\");\r\n// };\r\n\r\n// export const isLoggedIn = () => {\r\n//   return !!getToken();\r\n// };\r\n\r\n\r\n\r\n\r\nexport const setToken = (token) => {\r\n  localStorage.setItem(\"token\", token);\r\n};\r\n\r\nexport const getToken = () => {\r\n  return localStorage.getItem(\"token\");\r\n};\r\n\r\nexport const removeToken = () => {\r\n  localStorage.removeItem(\"token\");\r\n};\r\n\r\nexport const isLoggedIn = () => !!getToken();\r\n"],"names":[],"mappings":"AAAA,uCAAuC;AACvC,0CAA0C;AAC1C,KAAK;AAEL,kCAAkC;AAClC,0CAA0C;AAC1C,KAAK;AAEL,qCAAqC;AACrC,sCAAsC;AACtC,KAAK;AAEL,oCAAoC;AACpC,yBAAyB;AACzB,KAAK;;;;;;;;;;;AAKE,MAAM,WAAW,CAAC;IACvB,aAAa,OAAO,CAAC,SAAS;AAChC;AAEO,MAAM,WAAW;IACtB,OAAO,aAAa,OAAO,CAAC;AAC9B;AAEO,MAAM,cAAc;IACzB,aAAa,UAAU,CAAC;AAC1B;AAEO,MAAM,aAAa,IAAM,CAAC,CAAC","debugId":null}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file:///D:/FYP/Fyp/fyp/components/LoggedInNavbar.js"],"sourcesContent":["import { useRouter } from \"next/router\";\r\nimport { removeToken } from \"../lib/auth\";\r\n\r\nexport default function LoggedInNavbar() {\r\n  const router = useRouter();\r\n\r\n  const logout = () => {\r\n    removeToken();\r\n    router.push(\"/login\");\r\n  };\r\n\r\n  return (\r\n    <nav className=\"navbar\">\r\n      <div className=\"navbar-left\">\r\n        <h1 className=\"logo\">AI Document Guide</h1>\r\n      </div>\r\n      <div className=\"navbar-right\">\r\n        <a href=\"/dashboard\" className=\"nav-link\">Dashboard</a>\r\n        <a href=\"/chat\" className=\"nav-link\">Chat</a>\r\n        <button onClick={logout} className=\"btn-logout\">Logout</button>\r\n      </div>\r\n\r\n      <style jsx>{`\r\n        .navbar {\r\n          display: flex;\r\n          justify-content: space-between;\r\n          align-items: center;\r\n          padding: 1rem 2rem;\r\n          background: #171717;\r\n          color: white;\r\n        }\r\n        .logo {\r\n          font-size: 1.5rem;\r\n          font-weight: bold;\r\n        }\r\n        .navbar-right {\r\n          display: flex;\r\n          gap: 1rem;\r\n          align-items: center;\r\n        }\r\n        .nav-link {\r\n          background: #0070f3;\r\n          padding: 0.5rem 1rem;\r\n          border-radius: 5px;\r\n          color: white;\r\n          text-decoration: none;\r\n          transition: background 0.2s;\r\n        }\r\n        .nav-link:hover {\r\n          background: #0059c1;\r\n        }\r\n        .btn-logout {\r\n          background: #dc2626;\r\n          padding: 0.5rem 1rem;\r\n          border-radius: 5px;\r\n          border: none;\r\n          cursor: pointer;\r\n          color: white;\r\n          transition: background 0.2s;\r\n        }\r\n        .btn-logout:hover {\r\n          background: #b91c1c;\r\n        }\r\n      `}</style>\r\n    </nav>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;;;AAEe,SAAS;IACtB,MAAM,SAAS,IAAA,2IAAS;IAExB,MAAM,SAAS;QACb,IAAA,0HAAW;QACX,OAAO,IAAI,CAAC;IACd;IAEA,qBACE,qKAAC;kDAAc;;0BACb,qKAAC;0DAAc;0BACb,cAAA,qKAAC;8DAAa;8BAAO;;;;;;;;;;;0BAEvB,qKAAC;0DAAc;;kCACb,qKAAC;wBAAE,MAAK;kEAAuB;kCAAW;;;;;;kCAC1C,qKAAC;wBAAE,MAAK;kEAAkB;kCAAW;;;;;;kCACrC,qKAAC;wBAAO,SAAS;kEAAkB;kCAAa;;;;;;;;;;;;;;;;;;;;;;AA+CxD","debugId":null}},
    {"offset": {"line": 196, "column": 0}, "map": {"version":3,"sources":["file:///D:/FYP/Fyp/fyp/pages/chat.js"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/router\";\r\nimport api from \"../lib/api\";\r\nimport { getToken } from \"../lib/auth\";\r\nimport LoggedInNavbar from \"../components/LoggedInNavbar\";\r\n\r\nexport default function ChatPage() {\r\n  const router = useRouter();\r\n  const [chats, setChats] = useState([]);\r\n  const [selectedChat, setSelectedChat] = useState(null);\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Protect route\r\n  useEffect(() => {\r\n    const token = getToken();\r\n    if (!token) router.push(\"/login\");\r\n    fetchChats();\r\n  }, []);\r\n\r\n  const fetchChats = async () => {\r\n    const res = await api.get(\"/chats\", {\r\n      headers: { Authorization: `Bearer ${getToken()}` },\r\n    });\r\n    setChats(res.data);\r\n  };\r\n\r\n const startNewChat = () => {\r\n  setSelectedChat({ _id: null, title: \"New Chat (unsaved)\" });\r\n  setMessages([]);\r\n};\r\n\r\n  const openChat = async (chat) => {\r\n    const res = await api.get(`/chats/${chat._id}`, {\r\n      headers: { Authorization: `Bearer ${getToken()}` },\r\n    });\r\n    setSelectedChat(res.data);\r\n    setMessages(res.data.messages);\r\n  };\r\n\r\n//   const sendMessage = async () => {\r\n//   if (!input.trim()) return;\r\n\r\n//   const userMsg = { role: \"user\", content: input };\r\n//   setMessages((prev) => [...prev, userMsg]);\r\n//   setInput(\"\");\r\n//   setLoading(true);\r\n\r\n//   try {\r\n//     let reply;\r\n\r\n//     // if chat not yet created\r\n//     if (!selectedChat || !selectedChat._id) {\r\n//       const res = await api.post(\r\n//         \"/chats/new\",\r\n//         { message: input }, // send first message here\r\n//         { headers: { Authorization: `Bearer ${getToken()}` } }\r\n//       );\r\n//       setSelectedChat(res.data.chat);\r\n//       reply = res.data.reply;\r\n//     } else {\r\n//       const res = await api.post(\r\n//         `/chats/${selectedChat._id}/message`,\r\n//         { message: input },\r\n//         { headers: { Authorization: `Bearer ${getToken()}` } }\r\n//       );\r\n//       reply = res.data.reply;\r\n//     }\r\n\r\n//     setMessages((prev) => [...prev, { role: \"ai\", content: reply }]);\r\n//     fetchChats(); // refresh sidebar\r\n//   } catch (err) {\r\n//     console.error(\"Send message failed:\", err);\r\n//   } finally {\r\n//     setLoading(false);\r\n//   }\r\n// };\r\n\r\nconst sendMessage = async () => {\r\n  if (!input.trim()) return;\r\n\r\n  const userMsg = { role: \"user\", content: input };\r\n  setMessages((prev) => [...prev, userMsg]);\r\n  setInput(\"\");\r\n  setLoading(true);\r\n\r\n  try {\r\n    let reply;\r\n\r\n    if (!selectedChat || !selectedChat._id) {\r\n      const res = await api.post(\r\n        \"/chats/new\",\r\n        { message: input },\r\n        { headers: { Authorization: `Bearer ${getToken()}` } }\r\n      );\r\n      setSelectedChat(res.data.chat);\r\n      reply = res.data.reply;\r\n    } else {\r\n      const res = await api.post(\r\n        `/chats/${selectedChat._id}/message`,\r\n        { message: input, sessionId: selectedChat._id }, // ðŸ‘ˆ send sessionId\r\n        { headers: { Authorization: `Bearer ${getToken()}` } }\r\n      );\r\n      reply = res.data.reply;\r\n    }\r\n\r\n    setMessages((prev) => [...prev, { role: \"ai\", content: reply }]);\r\n    fetchChats();\r\n  } catch (err) {\r\n    console.error(\"Send message failed:\", err);\r\n  } finally {\r\n    setLoading(false);\r\n  }\r\n};\r\n\r\n\r\n\r\n  return (\r\n    <>\r\n      <LoggedInNavbar />\r\n      <div className=\"page\">\r\n        <div className=\"sidebar\">\r\n          <button onClick={startNewChat} className=\"new-btn\">+ New Chat</button>\r\n          <div className=\"chat-list\">\r\n            {chats.map((chat) => (\r\n              <div\r\n                key={chat._id}\r\n                onClick={() => openChat(chat)}\r\n                className={`chat-item ${selectedChat?._id === chat._id ? \"active\" : \"\"}`}\r\n              >\r\n                <strong>{chat.title}</strong>\r\n                <p>{chat.lastMessage?.slice(0, 30) || \"No messages yet\"}</p>\r\n                <small>{new Date(chat.updatedAt).toLocaleString()}</small>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"chat-area\">\r\n          {selectedChat ? (\r\n            <>\r\n              <div className=\"messages\">\r\n                {messages.map((msg, i) => (\r\n                  <div key={i} className={`msg ${msg.role}`}>\r\n                    {msg.content}\r\n                  </div>\r\n                ))}\r\n                {loading && <div className=\"msg ai\">Typing...</div>}\r\n              </div>\r\n              <div className=\"input-box\">\r\n                <input\r\n                  value={input}\r\n                  onChange={(e) => setInput(e.target.value)}\r\n                  onKeyDown={(e) => e.key === \"Enter\" && sendMessage()}\r\n                  placeholder=\"Type your message...\"\r\n                />\r\n                <button onClick={sendMessage}>Send</button>\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <div className=\"no-chat\">Select a chat or start a new one</div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <style jsx>{`\r\n        .page {\r\n          display: flex;\r\n          height: 90vh;\r\n        }\r\n        .sidebar {\r\n          width: 25%;\r\n          background: #f8f8f8;\r\n          padding: 1rem;\r\n          border-right: 1px solid #ddd;\r\n          display: flex;\r\n          flex-direction: column;\r\n        }\r\n        .new-btn {\r\n          background: #0070f3;\r\n          color: white;\r\n          border: none;\r\n          border-radius: 6px;\r\n          padding: 0.5rem;\r\n          cursor: pointer;\r\n          margin-bottom: 1rem;\r\n        }\r\n        .chat-item {\r\n          padding: 0.5rem;\r\n          margin-bottom: 0.5rem;\r\n          border-radius: 6px;\r\n          cursor: pointer;\r\n        }\r\n        .chat-item.active {\r\n          background: #e0e7ff;\r\n        }\r\n        .chat-area {\r\n          flex: 1;\r\n          display: flex;\r\n          flex-direction: column;\r\n        }\r\n        .messages {\r\n          flex: 1;\r\n          padding: 1rem;\r\n          overflow-y: auto;\r\n        }\r\n        .msg {\r\n          margin-bottom: 0.75rem;\r\n          padding: 0.75rem 1rem;\r\n          border-radius: 8px;\r\n          max-width: 70%;\r\n        }\r\n        .msg.user {\r\n          background: #0070f3;\r\n          color: white;\r\n          margin-left: auto;\r\n        }\r\n        .msg.ai {\r\n          background: #e5e7eb;\r\n          color: #333;\r\n        }\r\n        .input-box {\r\n          display: flex;\r\n          border-top: 1px solid #ddd;\r\n        }\r\n        input {\r\n          flex: 1;\r\n          padding: 1rem;\r\n          border: none;\r\n          outline: none;\r\n        }\r\n        button {\r\n          background: #0070f3;\r\n          color: white;\r\n          border: none;\r\n          padding: 1rem 1.5rem;\r\n          cursor: pointer;\r\n        }\r\n        .no-chat {\r\n          margin: auto;\r\n          color: #777;\r\n        }\r\n      `}</style>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}